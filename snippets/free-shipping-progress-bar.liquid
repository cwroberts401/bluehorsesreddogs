<!-- cart-price-update.liquid -->

<style>
  .cart-price-container {
    background-color: #f3f3f3; /* Light gray background */
    border-radius: 10px; /* Rounded corners */
    padding: 10px;
    margin-top: 10px; /* Adjust margin as needed */
    width: 200px; /* Adjust width as needed */
    box-shadow: 0 2px 4px rgba(0,0,0,0.1); /* Optional: Add shadow for depth */
  }

  .progress-bar {
    background-color: #b5e2a3; /* Green progress bar color */
    height: 10px; /* Height of the progress bar */
    border-radius: 5px; /* Rounded corners */
    margin-top: 5px; /* Adjust margin as needed */
    width: 0; /* Initial width, will be updated dynamically */
    z-index:2;
  }
  .progress-bar-bg {
    background-color: lightgray; /* Green progress bar color */
    height: 10px; /* Height of the progress bar */
    border-radius: 5px; /* Rounded corners */
    margin-top: -10px; /* Adjust margin as needed */
    width: 100%; /* Initial width, will be updated dynamically */
    z-index:1;
  }
</style>

<div class="cart-price-container">
  <div class="cart-price"> </div>
  <div class="progress-bar"> </div>
  <div class="progress-bar-bg"> </div>

  
</div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Function to fetch and update cart price
    function updateCartPrice() {
      fetch('/cart.js')
        .then(response => response.json())
        .then(data => {
          const cartPrice = data.total_price;
          // Update the cart price wherever needed on the page
          document.querySelector('.cart-price').innerText = cartPrice;
          // Calculate progress for the progress bar
          const freeShippingThreshold = 100; // Example free shipping threshold
          const progress = ((cartPrice/100) / freeShippingThreshold) * 100;
          // Update progress bar width
          document.querySelector('.progress-bar').style.width = progress + '%';
        })
        .catch(error => {
          console.error('Error fetching cart data:', error);
        });
    }

    // Update cart price on page load
    updateCartPrice();

    // Add event listeners to buttons within cart-item_quantity class
    var quantityButtons = document.querySelectorAll('.cart-item_quantity button');
    quantityButtons.forEach(function(button) {
      button.addEventListener('click', function(event) {
        // Perform action when a quantity button is clicked
        console.log('Quantity button clicked');
        // You can add your custom logic here, such as updating cart price
        updateCartPrice(); // Example: Update cart price when quantity button is clicked
      });
    });

    // Add event listeners to all buttons with type="submit"
    var submitButtons = document.querySelectorAll('button[type="submit"]');
    submitButtons.forEach(function(button) {
      button.addEventListener('click', function(event) {
        // Perform action when a submit button is clicked
        console.log('Submit button clicked');
        // You can add your custom logic here, such as updating cart price
        updateCartPrice(); // Example: Update cart price when submit button is clicked
      });
    });
  });
</script>

